import requests

# Define the URL and the restricted endpoint
base_url = "https://example.com"
restricted_endpoint = "/admin"

# Authentication details
auth_token = "your_auth_token_here"
auth_cookie = {"sessionid": "your_session_id_here"}

# Choose authentication method
use_token = True  # Set to False if using cookies

# Headers including the authentication token if using token-based auth
headers = {}
if use_token:
    headers["Authorization"] = f"Bearer {auth_token}"

# Make a request with authentication
response = requests.get(base_url + restricted_endpoint, headers=headers, cookies=None if use_token else auth_cookie)

# Check if the response status code indicates unauthorized access
if response.status_code == 200:
    print("Access control is working. Authorized user can access restricted endpoint.")
else:
    print(f"Access control is broken. Status code: {response.status_code}")
