import requests

# Define the URL and the endpoint with a placeholder for the object ID
base_url = "https://example.com/api/resource/"
valid_id = "12345"
invalid_id = "12346"  # Try to access another user's resource

# Authentication details
auth_token = "your_auth_token_here"
auth_cookie = {"sessionid": "your_session_id_here"}

# Choose authentication method
use_token = True  # Set to False if using cookies

# Headers including the authentication token if using token-based auth
headers = {}
if use_token:
    headers["Authorization"] = f"Bearer {auth_token}"

# Function to make a request and check access
def check_access(object_id):
    url = base_url + object_id
    response = requests.get(url, headers=headers, cookies=None if use_token else auth_cookie)
    if response.status_code == 200:
        print(f"Access to resource {object_id} is allowed. Potential IDOR vulnerability.")
    else:
        print(f"Access to resource {object_id} is restricted. Status code: {response.status_code}")

# Check access for valid and invalid IDs
check_access(valid_id)
check_access(invalid_id)
